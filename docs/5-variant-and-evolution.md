# 변이와 진화

## 변이 찾기 (Variant Calling)

변이 찾기는 주로 BAM 파일로부터 변이를 찾아주는 소프트웨어(variant caller)를 활용하는 과정이다. 이 과정은 개인의 유전체에서 참조 유전체과 다른 부분을 식별하는 중요한 단계이다. 여러 소프트웨어가 사용되는데, 대표적으로 GATK, SAMtools, FreeBayes, DeepVariant, Octopus 등이 있다.

GATK(Genome Analysis Toolkit)는 Broad Institute에서 개발한 가장 널리 사용되는 변이 호출 도구 중 하나이다. 특히 인간 유전체 프로젝트에서 많이 사용되었으며, 높은 정확도로 알려져 있다. SAMtools는 시퀀싱 데이터 처리를 위한 다양한 도구를 제공하는 소프트웨어 패키지이며, 변이 호출 기능도 포함하고 있다. FreeBayes는 베이지안 접근법을 사용하여 변이를 찾는 도구이고, DeepVariant는 구글에서 개발한 딥러닝 기반 변이 호출 도구로 최근 높은 정확도로 주목받고 있다. Octopus는 새로운 접근 방식을 통해 복잡한 변이도 찾아낼 수 있는 도구이다.

## VCF 포맷

VCF는 Variant Call Format의 약자로, 변이 정보를 저장하는 표준 파일 형식이다. 이 포맷은 유전체 위치, 참조 서열, 변이 서열 등 변이에 관한 중요 정보를 포함하고 있다.

VCF 파일의 주요 필드는 다음과 같다:
- CHROM, POS: 유전체 상의 위치(Genomic Locus)를 나타낸다. CHROM은 염색체 번호, POS는 해당 염색체 내 위치를 의미한다.
- ID: dbSNP와 같은 데이터베이스에 등록된 경우, 그 ID를 표시한다.
- REF: 참조 유전체(Reference Genome) 상의 염기 서열이다.
- ALT: 시퀀싱 데이터에서 얻은 변이된 염기 서열이다.
  - REF보다 ALT가 길면 삽입(insertion), 짧으면 결실(deletion)로, 이 둘을 합쳐 Indel이라 부른다. 길이가 같으면 단일 염기 변이(SNV, Single Nucleotide Variant)이다.
  - ALT가 쉼표로 구분되는 경우는 다중대립유전자 변이(Multiallelic Nucleotide Variant, MNV)이다.
- FILTER: 변이 호출 과정에서 문제가 있는 경우 표시되며, 문제가 없으면 "PASS"로 표시된다.

VCF 파일은 또한 INFO 필드에 변이에 대한 추가 정보와 FORMAT 필드에 각 샘플의 유전형(genotype) 정보를 포함한다. 이러한 구조로 인해 VCF는 다양한 유전체 분석 도구와 호환되며, 변이 정보를 효율적으로 저장하고 공유할 수 있다.

## Phasing

Phasing은 찾아낸 유전 변이(variant)가 포함된 대립유전자(allele)가 부계에서 왔는지 모계에서 왔는지 알아내는 과정이다. 이는 유전적 변이의 기원을 추적하고, 질병 연관성 등을 연구하는 데 중요한 정보이다.

Phasing을 수행하는 두 가지 주요 방법이 있다:
1. 부모의 시퀀싱 데이터를 기반으로 부계인지 모계인지를 결정하는 방법
2. 알고리즘을 통한 통계적 추정 방법 (이 경우 부계/모계 유전인지 정확하게 파악하는 것은 어렵다)

Phasing과 관련해 중요한 개념으로 Haplotype이 있다. Haplotype은 함께 유전되는 경향이 있는 유전자나 변이의 그룹을 의미한다. 이러한 haplotype 정보는 질병 연관성 연구, 집단 유전학, 진화 연구 등에서 중요하게 활용된다.

## Contamination

Contamination(오염)은 variant calling 과정에서 반드시 고려해야 할 중요한 요소이다. 시퀀싱 샘플에 다른 개체의 DNA가 섞여 있거나, 실험 과정에서 오염이 발생할 수 있기 때문이다.

오염은 다양한 원인으로 발생할 수 있다:
- 샘플 채취 과정에서의 오염
- 실험실 작업 중 교차 오염
- 시퀀싱 기기 자체의 오염
- 시약 오염

오염된 샘플은 잘못된 변이 호출로 이어질 수 있으며, 이는 연구 결과의 신뢰성에 심각한 영향을 미친다. 따라서 variant calling 전에 오염 여부를 확인하고, 오염된 경우 적절한 보정 방법을 적용하는 것이 중요하다. 대표적인 오염 확인 도구로는 VerifyBamID, ContEst 등이 있다.

## 개인 유전체 분석 과정

개인 유전체 분석은 일련의 단계를 거쳐 진행되는데, 이를 파이프라인이라고 부른다. 주요 단계는 다음과 같다:

1. Sequencing(시퀀싱): 개인의 DNA 샘플을 읽어 염기 서열 데이터를 생성한다.
2. Alignment(정렬): 생성된 시퀀스를 참조 유전체에 맞추어 정렬한다.
3. Variant Calling(변이 호출): 정렬된 데이터에서 참조 유전체과 다른 변이를 찾아낸다.
4. Gene set or Pathway analysis(유전자 세트 또는 경로 분석): 찾아낸 변이가 어떤 유전자나 생물학적 경로에 영향을 미치는지 분석한다.

이러한 파이프라인은 자동화되어 대량의 데이터를 효율적으로 처리할 수 있도록 설계된다. 각 단계마다 다양한 도구와 알고리즘이 사용되며, 연구 목적이나 대상 생물체에 따라 파이프라인을 조정할 수 있다.

## 생명정보학 현업 분류

생명정보학 분야는 크게 두두 가지로 분류할 수 있다:

1. 분석 알고리즘/소프트웨어 개발: 새로운 생물학적 데이터 분석 방법과 도구를 개발하는 분야이다. 이 분야에서는 프로그래밍과 데이터 사이언스 지식이 특히 중요하다.

2. 분석 파이프라인 구축: 기존의 도구들을 조합하여 특정 연구 목적에 맞는 분석 파이프라인을 구축하는 분야이다. 이 분야에서는 의생명 배경 지식이 강조된다.

프로그래밍, 통계, 의생명 지식을 모두 갖춘 전문가는 복잡한 생물학적 문제를 해결하는 데 큰 역할을 한다. 이런 종합적 능력을 갖춘 전문가는 매우 귀중한 인재로 간주된다.

## Hardy-Weinberg Equilibrium

우리는 이전 챕터에서 다양한 변이 데이터베이스에 대해 배웠다. 그러나 각 변이의 빈도는 시간에 따라 일정한가? 만약 그렇지 않다면, 변이 데이터베이스는 지속적으로 갱신되어야 한다는 의미가 된다.

이때 등장하는 것이 Hardy-Weinberg Equilibrium(하디-바인베르크 평형) 이다. 이것은 집단 유전학의 기본 원리 중 하나로, 특정 조건 하에서 대립유전자 빈도가 세대를 거쳐도 변하지 않는다는 이론이다.

하디-바인베르크 평형이 성립하려면 다음 조건이 필요하다:
1. 무작위 교배
2. 돌연변이 없음
3. 자연선택 없음
4. 이주 없음
5. 무한한 집단 크기

실제로는 이런 조건들이 모두 충족되기 어렵기 때문에, 하디-바인베르크 평형으로부터의 이탈은 진화의 증거로 볼 수 있다.

## Genetic Drift

Genetic Drift(유전적 부동)는 무작위적 과정에 의해 집단 내 대립유전자 빈도가 변화하는 현상이다. 특히 작은 집단에서 그 영향이 크게 나타난다.

라이트-피셔 모델(Wright-Fisher Model)은 유전적 부동을 설명하는 기본 모델이다:
- 두 개의 대립유전자 A와 a의 빈도가 각각 p와 q인 N 크기의 집단을 고려해보자.
- 총 대립유전자 수는 2N이 된다.
- 모델의 단순화를 위해 다음을 가정한다:
  - 한 세대는 번식 후 완전히 소멸한다.
  - 교배는 완전히 무작위적이다.
  - 집단의 크기는 2N으로 고정되어 있다.

다음 세대에서 특정 대립유전자가 k개 존재할 확률은 복원 추출이므로 이항 분포를 따르게 된다.

유전은 무작위적 과정이므로, 일부 대립유전자는 완전히 사라지거나 집단 내에서 우세해질 수 있다. 이는 하디-바인베르크 평형을 깨뜨리는 요인이 된다.

하디-바인베르크 평형이 깨졌을 때, 우리는 이 현상을 "진화(Evolution)"라고 부른다. 유전적 부동은 진화를 이끄는 기본적인 힘 중 하나이다.

## Evolution

진화(Evolution)는 생물 집단이 세대를 거치며 변화하는 과정이다. 찰스 다윈(Charles Darwin)은 이 개념을 체계화한 선구자로, HMS 비글호 항해와 다윈의 핀치 연구는 진화론 발전에 중요한 역할을 했다.

선택압(Selection Pressure)은 "진화적 압력(Evolutionary Pressure)"이라고도 불리며, 다음과 같은 요인들이 있다:
- 환경(기후, 지리 등)
- 다른 종과의 관계
- 교배를 촉진하거나 방해하는 기타 요인

진화의 세 가지 기본 메커니즘은 다음과 같다:
1. 무작위 돌연변이(Random Mutation)
2. 자연선택(Natural Selection)
3. 유전적 부동(Genetic Drift)

계통학(Phylogeny)은 종과 생물 그룹이 시간에 따라 어떻게 진화했는지 연구하는 학문이다. 이는 비슷한 생물이 공통 조상을 공유한다는 개념에 기초한다. 계통학은 생물 간의 자연적 관계를 반영하는 분류체계를 만드는 데 사용된다.

다중 서열 정렬(Multiple Sequence Alignment, MSA)은 진화적 관계를 파악하기 위해 서열을 정렬하는 기술이다. 예를 들어, COVID-19의 기원을 추적하는 데 사용되었다.

고유전학(Paleogenetics)은 고대 샘플에서 DNA를 시퀀싱하는 연구 분야이다. 스반테 페보(Svante Päabo)는 이 분야의 공로로 2022년 노벨상을 수상했으며, 네안데르탈인의 완전한 유전체 시퀀싱과 데니소바인의 미토콘드리아 DNA 시퀀싱 등의 업적을 이루었다.

이러한 연구들은 인류의 진화 역사와 다른 종과의 관계를 더 잘 이해하는 데 도움을 준다. 최신 유전체 분석 기술의 발전으로 진화 연구는 더욱 정확해지고 있으며, 생물의 다양성과 적응 메커니즘에 대한 지식을 넓히고 있다.